' Gambas class file

PUBLIC SUB Form_Open()
  DIM sOpcion AS String = FMain.sReproductor

  IF sOpcion = "REPRODUCTORINTERNO" THEN 
    RadioButton1.Value = TRUE
  ELSE 
    RadioButton2.Value = TRUE
    TextBox1.Text = sOpcion
  ENDIF 
  
  
END


PUBLIC SUB RadioButton2_Click()

  IF TextBox1.Enabled = FALSE THEN 
    TextBox1.Enabled = TRUE
  ENDIF 

END

PUBLIC SUB RadioButton1_Click()

  IF TextBox1.Enabled = TRUE THEN 
    TextBox1.Enabled = FALSE
  ENDIF 

END

PUBLIC SUB Button1_Click()
  DIM hConf AS Settings
  hConf = NEW Settings(User.Home &/ ".config/gambas" &/ Application.Name & ".conf")
  
  IF RadioButton1.Value = TRUE THEN 
    hConf["Reproductor"] = "REPRODUCTORINTERNO"
    FMain.sReproductor = "REPRODUCTORINTERNO"
    hConf.Save()
    hConf.Reload()
    ME.Close(2)
  ELSE 
    hConf["Reproductor"] = Trim(TextBox1.Text)
    FMain.sReproductor = Trim(TextBox1.Text)
     hConf.Save()
     hConf.Clear
    ME.Close(3)
  ENDIF  

END
